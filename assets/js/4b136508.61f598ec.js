"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[19],{8054:function(e,t,n){n.r(t),n.d(t,{contentTitle:function(){return d},default:function(){return u},frontMatter:function(){return l},metadata:function(){return p},toc:function(){return c}});var a=n(7462),i=n(3366),o=(n(7294),n(3905)),r=n(6213),s=["components"],l={id:"did",title:"\ud83d\udc64 Did"},d=void 0,p={unversionedId:"sdk/workshop/did",id:"sdk/workshop/did",isDocsHomePage:!1,title:"\ud83d\udc64 Did",description:"Time to make a DID using the previously created accounts for the claimer and the attester.",source:"@site/docs/sdk/1-workshop/04_did.md",sourceDirName:"sdk/1-workshop",slug:"/sdk/workshop/did",permalink:"/docs/sdk/workshop/did",editUrl:"https://github.com/KILTprotocol/docs/edit/master/docs/sdk/1-workshop/04_did.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"did",title:"\ud83d\udc64 Did"},sidebar:"sdk",previous:{title:"\ud83d\udc64 Account",permalink:"/docs/sdk/workshop/account"},next:{title:"\ud83d\udca0 CTYPE",permalink:"/docs/sdk/workshop/ctype"}},c=[{value:"Code",id:"code",children:[],level:2},{value:"Run",id:"run",children:[],level:2}],m={toc:c};function u(e){var t=e.components,n=(0,i.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Time to make a DID using the previously created accounts for the ",(0,o.kt)("span",{class:"label-role claimer"},"claimer")," and the ",(0,o.kt)("span",{class:"label-role attester"},"attester"),"."),(0,o.kt)("p",null,"In KILT, there is a DID may represents an entity - for example a person, an organization or even a machine."),(0,o.kt)("p",null,"A KILT Decentralised Identifier (DID) is a string uniquely identifying each KILT user.\nThe DID can contain multiple different keys, it can be thought of a controller account for the DID subject."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"KILT DID")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"An authentication keypair that is used to sign claims and attestations"),(0,o.kt)("li",{parentName:"ul"},"An encryption keypair, used to encrypt messages between participants of the system"),(0,o.kt)("li",{parentName:"ul"},"An attestation keypair, used to write ctypes and attestations on chain"),(0,o.kt)("li",{parentName:"ul"},"A delegation keypair, used to write delegations on the blockchain"),(0,o.kt)("li",{parentName:"ul"},"Keypairs can be replaced over time, even if the key has been compromised")))),(0,o.kt)("p",null,"There are different types of DIDs that can perform different actions, either a light or full DID."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Light DID")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"A light DIDs are less flexible and are suitable for lower-security use cases."),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Sign claims and attestations with the authentication keys"),(0,o.kt)("li",{parentName:"ul"},"Encrypting messages with the encryption keys")))),(0,o.kt)("p",null,"A full DID requires interaction with the KILT blockchain. The DID creation operation requires funds from the assoicated KILT address with enough funds to pay the transaction fees and the required deposit."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Full DID")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Full DID is robust and allows for more use cases."),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"Store multiple different keys and key types"),(0,o.kt)("li",{parentName:"ul"},"Has all features of a light DID"),(0,o.kt)("li",{parentName:"ul"},"Write delegations on the blockchain with the key type"),(0,o.kt)("li",{parentName:"ul"},"Creation of ctypes and attestations to be stored on the chain")))),(0,o.kt)("p",null,"In order for the ",(0,o.kt)("span",{class:"label-role attester"},"attesters")," to create the DID they have to pay the angel\u2019s share (gas or transaction fee) and despoit in KILT Tokens.\nSo you'll need tokens to create a full DID."),(0,o.kt)("p",null,"Go to the (",(0,o.kt)("a",{parentName:"p",href:"https://matrix.to/#/%23kilt-general:matrix.org"},"element")," and ",(0,o.kt)("a",{parentName:"p",href:"https://discord.gg/hX4pc8rdHS"},"discord"),") to request tokens for your ",(0,o.kt)("inlineCode",{parentName:"p"},"<attesterAddress>"),"."),(0,o.kt)("p",null,"Sadly these are just play tokens, not real money."),(0,o.kt)("p",null,"Before the creation of a DID there needs to be a keystore."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Keystore")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"A keystore has multiple purposes:"),(0,o.kt)("ul",{parentName:"div"},(0,o.kt)("li",{parentName:"ul"},"The keystore can hold multiple DID keypairs and key types"),(0,o.kt)("li",{parentName:"ul"},"The keystore stores the keys encrypted"),(0,o.kt)("li",{parentName:"ul"},"The keystore can be used to encrypt and decrypt data")))),(0,o.kt)("h2",{id:"code"},"Code"),(0,o.kt)("p",null,"First, the construction of the keystore."),(0,o.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"danger")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Caution the following keystore is only for demo purposes and considered unsafe."))),(0,o.kt)("p",null,"Create a new file ",(0,o.kt)("inlineCode",{parentName:"p"},"keystore.js")," and copy the following code:"),(0,o.kt)(r.Z,{className:"language-ts",mdxType:"CodeBlock"},"import * as Kilt from '@kiltprotocol/sdk-js'\n\nexport async function main() {\n  const keystore = new Kilt.Did.DemoKeystore()\n\n  return keystore\n}\n"),(0,o.kt)("p",null,"Taking the claimer and attester accounts to generate the DID and the assoicated keys."),(0,o.kt)("p",null,"Create a new file ",(0,o.kt)("inlineCode",{parentName:"p"},"claimersDid.js"),".\nTo generate a light DID, you will need the claimers account:"),(0,o.kt)(r.Z,{className:"language-ts",mdxType:"CodeBlock"},"import * as Kilt from '@kiltprotocol/sdk-js'\n\nexport async function main(\n  keystore: Kilt.Did.DemoKeystore\n): Promise<[Kilt.Did.LightDidDetails, Kilt.Did.DemoKeystore]> {\n  const claimerMnemonic =\n    'gold upset segment cake universe carry demand comfort dawn invite element capital'\n\n  const claimerSigningKeypair = await keystore.generateKeypair({\n    alg: Kilt.Did.SigningAlgorithms.Ed25519,\n    seed: claimerMnemonic,\n  })\n  const claimerEncryptionKeypair = await keystore.generateKeypair({\n    alg: Kilt.Did.EncryptionAlgorithms.NaclBox,\n    seed: claimerMnemonic,\n  })\n\n  const claimerLightDid = new Kilt.Did.LightDidDetails({\n    authenticationKey: {\n      publicKey: claimerSigningKeypair.publicKey,\n      type: Kilt.Did.DemoKeystore.getKeypairTypeForAlg(\n        claimerSigningKeypair.alg\n      ),\n    },\n    encryptionKey: {\n      publicKey: claimerEncryptionKeypair.publicKey,\n      type: Kilt.Did.DemoKeystore.getKeypairTypeForAlg(\n        claimerEncryptionKeypair.alg\n      ),\n    },\n  })\n\n  console.log('Claimers Light DID:', claimerLightDid)\n\n  return [claimerLightDid, keystore]\n}\n"),(0,o.kt)("p",null,"Create a new file ",(0,o.kt)("inlineCode",{parentName:"p"},"attestersDid.js"),".\nTo generate a full DID, you will need the claimers account and creation of the corresponding keypairs:"),(0,o.kt)(r.Z,{className:"language-ts",mdxType:"CodeBlock"},"import * as Kilt from '@kiltprotocol/sdk-js'\n\nexport async function main(\n  attester: Kilt.KeyringPair,\n  attesterMnemonic: string,\n  keystore: Kilt.Did.DemoKeystore\n): Promise<[Kilt.Did.FullDidDetails, Kilt.Did.DemoKeystore]> {\n  await Kilt.connect()\n\n  // Signing keypair\n  const attesterSigningKeypair = await keystore.generateKeypair({\n    alg: Kilt.Did.SigningAlgorithms.Ed25519,\n    seed: attesterMnemonic,\n  })\n\n  // Encryption keypair\n  const attesterEncryptionKeypair = await keystore.generateKeypair({\n    alg: Kilt.Did.EncryptionAlgorithms.NaclBox,\n    seed: attesterMnemonic,\n  })\n\n  const keys: Partial<\n    Record<Kilt.KeyRelationship, Kilt.Did.DidTypes.INewPublicKey<string>>\n  > = {\n    authentication: {\n      publicKey: attesterSigningKeypair.publicKey,\n      type: Kilt.Did.DemoKeystore.getKeypairTypeForAlg(\n        attesterSigningKeypair.alg\n      ),\n    },\n    keyAgreement: {\n      publicKey: attesterEncryptionKeypair.publicKey,\n      type: Kilt.Did.DemoKeystore.getKeypairTypeForAlg(\n        attesterEncryptionKeypair.alg\n      ),\n    },\n    capabilityDelegation: {\n      publicKey: attesterSigningKeypair.publicKey,\n      type: Kilt.Did.DemoKeystore.getKeypairTypeForAlg(\n        attesterSigningKeypair.alg\n      ),\n    },\n    assertionMethod: {\n      publicKey: attesterSigningKeypair.publicKey,\n      type: Kilt.Did.DemoKeystore.getKeypairTypeForAlg(\n        attesterSigningKeypair.alg\n      ),\n    },\n  }\n\n  const { extrinsic, did } = await Kilt.Did.DidUtils.writeDidFromPublicKeys(\n    keystore,\n    attester.address,\n    keys\n  )\n\n  await Kilt.BlockchainUtils.signAndSubmitTx(extrinsic, attester, {\n    reSign: true,\n    resolveOn: Kilt.BlockchainUtils.IS_FINALIZED,\n  })\n\n  const attesterFullDid = await Kilt.Did.DefaultResolver.resolveDoc(did)\n\n  console.log('Attesters Full DID:', attesterFullDid)\n  await Kilt.disconnect()\n\n  return [attesterFullDid.details as Kilt.Did.FullDidDetails, keystore]\n}\n"),(0,o.kt)("p",null,"Now its time to make the DID's."),(0,o.kt)("h2",{id:"run"},"Run"),(0,o.kt)("p",null,"The keystore should be instantiated once and used within the workshop passing it through the different stages of the workshop, run this command in your terminal, still within your ",(0,o.kt)("inlineCode",{parentName:"p"},"kilt-rocks")," directory:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"node keystore.js\n")),(0,o.kt)("p",null,"To generate the light DID, run this command in your terminal:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"node claimersDid.js\n")),(0,o.kt)("p",null,"Your output should look like this (but it won't be identical since the DIDs are constructed from your account):"),(0,o.kt)("p",null,"// Example of a light DID Identifier:\n",(0,o.kt)("inlineCode",{parentName:"p"},"did:kilt:light:014ons5NFdNeaVfxCkcXhPc9Hv2pWNR5muzuxW3iGTHUKuMnCS:oWFlomlwdWJsaWNLZXlYIBsVppuQ2fi/beBdYf50+n/36FnCjMw+KLSu3AmW9DEGZHR5cGVmeDI1NTE5")),(0,o.kt)("p",null,"Now to generate the full DID, ensure that you have funds on the account, run this command in your terminal:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"node attestersDid.js\n")),(0,o.kt)("p",null,"The keystore and the two DID's need to be stored for re-use."),(0,o.kt)("p",null,"Well done - You've successfully generated a light and full DID!"))}u.isMDXComponent=!0}}]);